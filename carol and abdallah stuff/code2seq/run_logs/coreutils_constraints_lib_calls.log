650
50
/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:526: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:527: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:528: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:529: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:530: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:535: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Namespace(data_path='data/coreutils_lib_calls/coreutils_lib_calls', debug=False, load_path='models/coreutils_lib_calls/model_iter27', max_path_len=650, predict=False, release=False, save_path_prefix='models/coreutils_lib_calls/model', seed=239, test_path='data/coreutils_lib_calls/coreutils_lib_calls.val.c2s', vocab_max=50)
2020-10-31 00:14:46.586204: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-10-31 00:14:46.650909: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2020-10-31 00:14:46.684004: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55caf5a95a80 executing computations on platform Host. Devices:
2020-10-31 00:14:46.684162: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
Loading dictionaries from: models/coreutils_lib_calls/model_iter27
Done loading dictionaries
Created model
Starting training

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/reader.py:101: to_int64 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/reader.py:161: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:1419: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/model.py:483: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/model.py:495: bidirectional_dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.Bidirectional(keras.layers.RNN(cell))`, which is equivalent to this API
WARNING:tensorflow:From /home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/rnn.py:443: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
WARNING:tensorflow:From /home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/rnn.py:626: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/rnn_cell_impl.py:1259: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/model.py:542: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
WARNING:tensorflow:From /home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/model.py:409: MultiRNNCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.StackedRNNCells, and will be replaced by that in Tensorflow 2.0.
Training batch size:			 128
Dataset path:				 data/coreutils_lib_calls/coreutils_lib_calls
Training file path:			 data/coreutils_lib_calls/coreutils_lib_calls.train.c2s
Validation path:			 data/coreutils_lib_calls/coreutils_lib_calls.val.c2s
Taking max contexts from each example:	 10
Random path sampling:			 False
Embedding size:				 128
Using BiLSTMs, each of size:		 128
Decoder size:				 320
Decoder layers:				 1
Max path lengths:			 650
Max subtokens in a token:		 1
Max target length:			 6
Embeddings dropout keep_prob:		 0.75
LSTM dropout keep_prob:			 0.5
============================================
Number of trainable params: 1775616
Initalized variables
WARNING:tensorflow:From /home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
Done loading model
Started reader...
Average loss at batch 100: 0.546288, 	throughput: 8 samples/sec
Average loss at batch 200: 0.571147, 	throughput: 10 samples/sec
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h3m20s
Accuracy after 28 epochs: 0.01510
After 28 epochs: Precision: 0.31928, recall: 0.23722, F1: 0.27220
Rouge:  {'rouge-1': {'f': 0.21122119658605026, 'p': 0.21865835777126216, 'r': 0.2092130987292277}, 'rouge-2': {'f': 0.004701857243756929, 'p': 0.005131964809384164, 'r': 0.00442326490713587}, 'rouge-l': {'f': 0.2087260051774636, 'p': 0.21865835777126216, 'r': 0.2092130987292277}}
Saved after 28 epochs in: models/coreutils_lib_calls/model_iter28
Average loss at batch 300: 0.536734, 	throughput: 8 samples/sec
Average loss at batch 400: 0.486497, 	throughput: 9 samples/sec
Average loss at batch 500: 0.520679, 	throughput: 9 samples/sec
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h3m18s
Accuracy after 29 epochs: 0.00704
After 29 epochs: Precision: 0.33035, recall: 0.24660, F1: 0.28240
Rouge:  {'rouge-1': {'f': 0.21933982519439305, 'p': 0.2439027370478994, 'r': 0.21174242424242146}, 'rouge-2': {'f': 0.004780058612222226, 'p': 0.005180840664711632, 'r': 0.004521016617790807}, 'rouge-l': {'f': 0.21192598620003159, 'p': 0.2439027370478994, 'r': 0.21174242424242146}}
Saved after 29 epochs in: models/coreutils_lib_calls/model_iter29
Average loss at batch 600: 0.403044, 	throughput: 8 samples/sec
Average loss at batch 700: 0.508915, 	throughput: 9 samples/sec
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h3m13s
Accuracy after 30 epochs: 0.00469
After 30 epochs: Precision: 0.30634, recall: 0.22640, F1: 0.26037
Rouge:  {'rouge-1': {'f': 0.1923055424737725, 'p': 0.1928641251221907, 'r': 0.19264418377321696}, 'rouge-2': {'f': 0.005361681287745193, 'p': 0.005791788856304985, 'r': 0.005083088954056696}, 'rouge-l': {'f': 0.19177256435306175, 'p': 0.1928641251221907, 'r': 0.19264418377321696}}
Average loss at batch 800: 0.477040, 	throughput: 8 samples/sec
Average loss at batch 900: 0.348941, 	throughput: 9 samples/sec
Average loss at batch 1000: 0.404727, 	throughput: 10 samples/sec
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h3m10s
Accuracy after 31 epochs: 0.00455
After 31 epochs: Precision: 0.31826, recall: 0.22929, F1: 0.26655
Rouge:  {'rouge-1': {'f': 0.19540147878579098, 'p': 0.198326001955035, 'r': 0.1952590420332361}, 'rouge-2': {'f': 0.005591397806448351, 'p': 0.005816226783968721, 'r': 0.005645161290322583}, 'rouge-l': {'f': 0.194007909652924, 'p': 0.198326001955035, 'r': 0.1952590420332361}}
Average loss at batch 1100: 0.328101, 	throughput: 8 samples/sec
Average loss at batch 1200: 0.352994, 	throughput: 10 samples/sec
Average loss at batch 1300: 0.365440, 	throughput: 10 samples/sec
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h3m11s
Accuracy after 32 epochs: 0.00455
After 32 epochs: Precision: 0.31889, recall: 0.24270, F1: 0.27563
Rouge:  {'rouge-1': {'f': 0.20922496701584697, 'p': 0.2208455522971664, 'r': 0.20657380254154406}, 'rouge-2': {'f': 0.009198435909631804, 'p': 0.00972629521016617, 'r': 0.009335288367546431}, 'rouge-l': {'f': 0.20506574071075057, 'p': 0.2208455522971664, 'r': 0.20657380254154406}}
Average loss at batch 1400: 0.275206, 	throughput: 8 samples/sec
Average loss at batch 1500: 0.420766, 	throughput: 10 samples/sec
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h3m14s
Accuracy after 33 epochs: 0.00601
After 33 epochs: Precision: 0.37981, recall: 0.27140, F1: 0.31658
Rouge:  {'rouge-1': {'f': 0.24828969232036577, 'p': 0.29960899315738165, 'r': 0.2319159335288305}, 'rouge-2': {'f': 0.008030302975607697, 'p': 0.009017595307917892, 'r': 0.007771260997067454}, 'rouge-l': {'f': 0.23301817358254262, 'p': 0.29960899315738165, 'r': 0.2319159335288305}}
Saved after 33 epochs in: models/coreutils_lib_calls/model_iter33
Average loss at batch 1600: 0.380454, 	throughput: 8 samples/sec
Average loss at batch 1700: 0.321057, 	throughput: 10 samples/sec
Average loss at batch 1800: 0.336743, 	throughput: 10 samples/sec
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h3m8s
Accuracy after 34 epochs: 0.00499
After 34 epochs: Precision: 0.35324, recall: 0.25788, F1: 0.29812
Rouge:  {'rouge-1': {'f': 0.22816331348581684, 'p': 0.25663489736070516, 'r': 0.2203690127077197}, 'rouge-2': {'f': 0.011173020455043996, 'p': 0.011632453567937424, 'r': 0.011779081133919832}, 'rouge-l': {'f': 0.21891005947442482, 'p': 0.25663489736070516, 'r': 0.2203690127077197}}
Average loss at batch 1900: 0.271801, 	throughput: 8 samples/sec
Average loss at batch 2000: 0.353783, 	throughput: 10 samples/sec
Average loss at batch 2100: 0.343338, 	throughput: 10 samples/sec
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h3m4s
Accuracy after 35 epochs: 0.00499
After 35 epochs: Precision: 0.33531, recall: 0.27222, F1: 0.30049
Rouge:  {'rouge-1': {'f': 0.24883465811439903, 'p': 0.3009530791788871, 'r': 0.23186705767350285}, 'rouge-2': {'f': 0.009921798562838067, 'p': 0.012170087976539576, 'r': 0.009090909090909097}, 'rouge-l': {'f': 0.23338638064429967, 'p': 0.3009530791788871, 'r': 0.23186705767350285}}
Average loss at batch 2200: 0.289029, 	throughput: 8 samples/sec
Average loss at batch 2300: 0.343635, 	throughput: 10 samples/sec
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h3m9s
Accuracy after 36 epochs: 0.00411
After 36 epochs: Precision: 0.35198, recall: 0.25688, F1: 0.29700
Rouge:  {'rouge-1': {'f': 0.2275610931292667, 'p': 0.25691593352883824, 'r': 0.2189882697947186}, 'rouge-2': {'f': 0.010767350855604447, 'p': 0.011779081133919829, 'r': 0.01094819159335287}, 'rouge-l': {'f': 0.2182727487564704, 'p': 0.25691593352883824, 'r': 0.2189882697947186}}
Average loss at batch 2400: 0.295563, 	throughput: 9 samples/sec
Average loss at batch 2500: 0.324176, 	throughput: 10 samples/sec
Average loss at batch 2600: 0.293205, 	throughput: 10 samples/sec
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h3m10s
Accuracy after 37 epochs: 0.00718
After 37 epochs: Precision: 0.36610, recall: 0.26411, F1: 0.30685
Rouge:  {'rouge-1': {'f': 0.2401480222323461, 'p': 0.28004643206256274, 'r': 0.2276392961876789}, 'rouge-2': {'f': 0.009682306873809067, 'p': 0.011510263929618764, 'r': 0.009164222873900299}, 'rouge-l': {'f': 0.22798160620726354, 'p': 0.28004643206256274, 'r': 0.2276392961876789}}
Average loss at batch 2700: 0.224278, 	throughput: 8 samples/sec
Average loss at batch 2800: 0.375697, 	throughput: 10 samples/sec
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h3m13s
Accuracy after 38 epochs: 0.00587
After 38 epochs: Precision: 0.35472, recall: 0.26218, F1: 0.30151
Rouge:  {'rouge-1': {'f': 0.23472838815232686, 'p': 0.26864613880743066, 'r': 0.22421798631475706}, 'rouge-2': {'f': 0.011515151432701223, 'p': 0.013391984359726277, 'r': 0.01109481915933527}, 'rouge-l': {'f': 0.22427704911560942, 'p': 0.26864613880743066, 'r': 0.22421798631475706}}
Average loss at batch 2900: 0.265119, 	throughput: 8 samples/sec
Average loss at batch 3000: 0.272120, 	throughput: 10 samples/sec
2020-10-31 11:29:17.478181: W tensorflow/core/framework/op_kernel.cc:1401] OP_REQUIRES failed at transpose_op.cc:199 : Resource exhausted: OOM when allocating tensor with shape[1280,650,128] and type float on /job:localhost/replica:0/task:0/device:CPU:0 by allocator cpu
2020-10-31 11:29:17.708951: W tensorflow/core/framework/op_kernel.cc:1401] OP_REQUIRES failed at transpose_op.cc:199 : Resource exhausted: OOM when allocating tensor with shape[1280,650,128] and type float on /job:localhost/replica:0/task:0/device:CPU:0 by allocator cpu
Traceback (most recent call last):
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1334, in _do_call
    return fn(*args)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1319, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1407, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[1280,650,128] and type float on /job:localhost/replica:0/task:0/device:CPU:0 by allocator cpu
	 [[{{node model/gradients/model/bidirectional_rnn/fw/fw/transpose_grad/transpose}}]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "code2seq.py", line 45, in <module>
    model.train()
  File "/home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/model.py", line 96, in train
    _, batch_loss = self.sess.run([optimizer, train_loss])
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 929, in run
    run_metadata_ptr)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1152, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1328, in _do_run
    run_metadata)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1348, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[1280,650,128] and type float on /job:localhost/replica:0/task:0/device:CPU:0 by allocator cpu
	 [[node model/gradients/model/bidirectional_rnn/fw/fw/transpose_grad/transpose (defined at /home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/model.py:390) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


Caused by op 'model/gradients/model/bidirectional_rnn/fw/fw/transpose_grad/transpose', defined at:
  File "code2seq.py", line 45, in <module>
    model.train()
  File "/home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/model.py", line 78, in train
    optimizer, train_loss = self.build_training_graph(self.queue_thread.get_output())
  File "/home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/model.py", line 390, in build_training_graph
    train_op = optimizer.minimize(loss, global_step=step)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/training/optimizer.py", line 403, in minimize
    grad_loss=grad_loss)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/training/optimizer.py", line 512, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/gradients_impl.py", line 664, in gradients
    unconnected_gradients)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/gradients_impl.py", line 965, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/gradients_impl.py", line 420, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/gradients_impl.py", line 965, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/array_grad.py", line 546, in _TransposeGrad
    return [array_ops.transpose(grad, array_ops.invert_permutation(p)), None]
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/array_ops.py", line 1674, in transpose
    ret = transpose_fn(a, perm, name=name)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/gen_array_ops.py", line 10238, in transpose
    "Transpose", x=x, perm=perm, name=name)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 3300, in create_op
    op_def=op_def)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 1801, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'model/bidirectional_rnn/fw/fw/transpose', defined at:
  File "code2seq.py", line 45, in <module>
    model.train()
[elided 0 identical lines from previous traceback]
  File "/home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/model.py", line 78, in train
    optimizer, train_loss = self.build_training_graph(self.queue_thread.get_output())
  File "/home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/model.py", line 369, in build_training_graph
    path_lengths=path_lengths, path_target_lengths=path_target_lengths)
  File "/home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/model.py", line 533, in compute_contexts
    is_evaluating)  # (batch, max_contexts, rnn_size)
  File "/home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/model.py", line 470, in calculate_path_abstraction
    return self.path_rnn_last_state(is_evaluating, path_embed, path_lengths, valid_contexts_mask)
  File "/home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/model.py", line 495, in path_rnn_last_state
    sequence_length=lengths)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/util/deprecation.py", line 324, in new_func
    return func(*args, **kwargs)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/rnn.py", line 443, in bidirectional_dynamic_rnn
    time_major=time_major, scope=fw_scope)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/util/deprecation.py", line 324, in new_func
    return func(*args, **kwargs)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/rnn.py", line 622, in dynamic_rnn
    flat_input = tuple(_transpose_batch_time(input_) for input_ in flat_input)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/rnn.py", line 622, in <genexpr>
    flat_input = tuple(_transpose_batch_time(input_) for input_ in flat_input)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/rnn.py", line 64, in _transpose_batch_time
    ([1, 0], math_ops.range(2, x_rank)), axis=0))
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/array_ops.py", line 1674, in transpose
    ret = transpose_fn(a, perm, name=name)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/ops/gen_array_ops.py", line 10238, in transpose
    "Transpose", x=x, perm=perm, name=name)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/abdallahy/miniconda3/envs/cs236781-hw/lib/python3.7/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[1280,650,128] and type float on /job:localhost/replica:0/task:0/device:CPU:0 by allocator cpu
	 [[node model/gradients/model/bidirectional_rnn/fw/fw/transpose_grad/transpose (defined at /home/abdallahy/Security_Project/sec_binary2name/binary2name/code2seq/model.py:390) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


